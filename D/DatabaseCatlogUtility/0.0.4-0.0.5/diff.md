# Comparing `tmp/DatabaseCatlogUtility-0.0.4-py3-none-any.whl.zip` & `tmp/DatabaseCatlogUtility-0.0.5-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,20 +1,20 @@
-Zip file size: 30008 bytes, number of entries: 18
--rw-rw-r--  2.0 unx    10283 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseAmazonRedshift.py
--rw-rw-r--  2.0 unx    10109 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseDremio.py
--rw-rw-r--  2.0 unx    10279 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseGoogleBigQuery.py
--rw-rw-r--  2.0 unx    10231 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseInMemory.py
--rw-rw-r--  2.0 unx    10486 b- defN 22-Dec-12 10:57 DatabaseCatlogUtility/DatabaseMSSQLServer.py
--rw-rw-r--  2.0 unx    10556 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseMySql.py
--rw-rw-r--  2.0 unx    10491 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseOracle.py
--rw-rw-r--  2.0 unx    10470 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabasePostgress.py
--rw-rw-r--  2.0 unx     9937 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseSAPHANA.py
--rw-rw-r--  2.0 unx    10345 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseSQLServer.py
--rw-rw-r--  2.0 unx    10242 b- defN 22-Dec-07 04:40 DatabaseCatlogUtility/DatabaseSnowFlake.py
--rw-rw-r--  2.0 unx     3909 b- defN 22-Dec-12 10:56 DatabaseCatlogUtility/Databasecatlog.py
--rw-rw-r--  2.0 unx      532 b- defN 22-Dec-12 10:45 DatabaseCatlogUtility/__init__.py
--rw-rw-r--  2.0 unx     1073 b- defN 22-Dec-12 11:01 DatabaseCatlogUtility-0.0.4.dist-info/LICENCE.txt
--rw-rw-r--  2.0 unx      591 b- defN 22-Dec-12 11:01 DatabaseCatlogUtility-0.0.4.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 22-Dec-12 11:01 DatabaseCatlogUtility-0.0.4.dist-info/WHEEL
--rw-rw-r--  2.0 unx       22 b- defN 22-Dec-12 11:01 DatabaseCatlogUtility-0.0.4.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1742 b- defN 22-Dec-12 11:01 DatabaseCatlogUtility-0.0.4.dist-info/RECORD
-18 files, 121390 bytes uncompressed, 27086 bytes compressed:  77.7%
+Zip file size: 30295 bytes, number of entries: 18
+-rw-rw-r--  2.0 unx    10952 b- defN 23-Jul-27 15:09 DatabaseCatlogUtility/DatabaseAmazonRedshift.py
+-rw-rw-r--  2.0 unx    10692 b- defN 23-Jul-28 13:20 DatabaseCatlogUtility/DatabaseDremio.py
+-rw-rw-r--  2.0 unx    10279 b- defN 23-Jul-27 05:04 DatabaseCatlogUtility/DatabaseGoogleBigQuery.py
+-rw-rw-r--  2.0 unx    10820 b- defN 23-Jul-28 13:18 DatabaseCatlogUtility/DatabaseInMemory.py
+-rw-rw-r--  2.0 unx    10467 b- defN 23-Jul-27 05:04 DatabaseCatlogUtility/DatabaseMSSQLServer.py
+-rw-rw-r--  2.0 unx    10556 b- defN 23-Jul-27 05:04 DatabaseCatlogUtility/DatabaseMySql.py
+-rw-rw-r--  2.0 unx    10568 b- defN 23-Jul-28 09:20 DatabaseCatlogUtility/DatabaseOracle.py
+-rw-rw-r--  2.0 unx    10470 b- defN 23-Jul-27 05:04 DatabaseCatlogUtility/DatabasePostgress.py
+-rw-rw-r--  2.0 unx     9936 b- defN 23-Jul-28 09:23 DatabaseCatlogUtility/DatabaseSAPHANA.py
+-rw-rw-r--  2.0 unx    10443 b- defN 23-Jul-27 05:04 DatabaseCatlogUtility/DatabaseSQLServer.py
+-rw-rw-r--  2.0 unx    10903 b- defN 23-Jul-27 15:16 DatabaseCatlogUtility/DatabaseSnowFlake.py
+-rw-rw-r--  2.0 unx     3890 b- defN 23-Jul-27 05:04 DatabaseCatlogUtility/Databasecatlog.py
+-rw-rw-r--  2.0 unx      532 b- defN 23-Jul-28 13:48 DatabaseCatlogUtility/__init__.py
+-rw-rw-r--  2.0 unx     1073 b- defN 23-Jul-28 13:50 DatabaseCatlogUtility-0.0.5.dist-info/LICENCE.txt
+-rw-rw-r--  2.0 unx      541 b- defN 23-Jul-28 13:50 DatabaseCatlogUtility-0.0.5.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Jul-28 13:50 DatabaseCatlogUtility-0.0.5.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       22 b- defN 23-Jul-28 13:50 DatabaseCatlogUtility-0.0.5.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1742 b- defN 23-Jul-28 13:50 DatabaseCatlogUtility-0.0.5.dist-info/RECORD
+18 files, 123978 bytes uncompressed, 27373 bytes compressed:  77.9%
```

## zipnote {}

```diff
@@ -33,23 +33,23 @@
 
 Filename: DatabaseCatlogUtility/Databasecatlog.py
 Comment: 
 
 Filename: DatabaseCatlogUtility/__init__.py
 Comment: 
 
-Filename: DatabaseCatlogUtility-0.0.4.dist-info/LICENCE.txt
+Filename: DatabaseCatlogUtility-0.0.5.dist-info/LICENCE.txt
 Comment: 
 
-Filename: DatabaseCatlogUtility-0.0.4.dist-info/METADATA
+Filename: DatabaseCatlogUtility-0.0.5.dist-info/METADATA
 Comment: 
 
-Filename: DatabaseCatlogUtility-0.0.4.dist-info/WHEEL
+Filename: DatabaseCatlogUtility-0.0.5.dist-info/WHEEL
 Comment: 
 
-Filename: DatabaseCatlogUtility-0.0.4.dist-info/top_level.txt
+Filename: DatabaseCatlogUtility-0.0.5.dist-info/top_level.txt
 Comment: 
 
-Filename: DatabaseCatlogUtility-0.0.4.dist-info/RECORD
+Filename: DatabaseCatlogUtility-0.0.5.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## DatabaseCatlogUtility/DatabaseAmazonRedshift.py

```diff
@@ -8,22 +8,28 @@
     
     def getTables(self,connectObj, dbDetails, userInfo, tableName=""):
         logger.log(f"Inside DatabaseAmazonRedshift getTables()","0")
         resultStr = ""
         isTableFound = False
         schemaName = ""
         maxCount="500"
-        
+        dbName = ""
         try:
             if len(userInfo) != 0:
-                if "transDB" in userInfo.keys():
-                    if len(userInfo["transDB"]) != "" : 
-                        transDB = userInfo["transDB"]
-                 
-                schemaName = "'" + userInfo["transDB"] + "." + userInfo["transDB"] + "'"
+                if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+                    dbName = dbDetails["DATABASE_SCHEMA"]
+                    logger.log(f"dbName:::{dbName}", "0")
+                    
+                else:
+                    if "transDB" in userInfo.keys():
+                        if len(userInfo["transDB"]) != "" : 
+                            dbName = userInfo["transDB"]
+                
+                schemaName =  "'" + dbName + "." + dbName + "'"
+                logger.log(f"schemaName:::{schemaName}", "0")  
                 
                 if ("" == tableName) :	
                     selectQuery = '''select TABLE_NAME from INFORMATION_SCHEMA."TABLES" where table_type='TABLE' and table_schema= ''' + schemaName + " LIMIT " + maxCount
                     logger.log(f"Inside DatabaseAmazonRedshift getTables selectQuery: {selectQuery}","0")
                     cursor = connectObj.cursor()
                     cursor.execute(selectQuery)
                     resultStr = cursor.fetchall()
@@ -64,20 +70,29 @@
             if connectObj != None:
                 connectObj.close()
         
         return resultStr    
             
     def getColumns(self, connectObj, tableNames, userInfo, dbDetails):
         logger.log(f"Inside DatabaseAmazonRedshift getColumns ","0")
-        if "transDB" in userInfo.keys():
-            if len(userInfo["transDB"]) != "" : 
-                transDB = userInfo["transDB"]
-                
         resultStr=""        
         mainDataArray=[]
+        dbName = ""
+
+        if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+            dbName = dbDetails["DATABASE_SCHEMA"]
+            logger.log(f"dbName:::{dbName}", "0")
+            
+        else:
+            if "transDB" in userInfo.keys():
+                if len(userInfo["transDB"]) != "" : 
+                    dbName = userInfo["transDB"]
+        
+        schemaName =  "'" + dbName + "." + dbName + "'"
+        logger.log(f"schemaName:::{schemaName}", "0")  
         
         try:
             if len(userInfo) != 0:  
                 if  ("" != tableNames.upper()) or ("" != tableNames.lower()):
                     
                     tableArray = tableNames.split(",")
                     counter = 0 
@@ -86,15 +101,15 @@
                         logger.log(f" Connected InMemory.","0")
 
                     for j in range(len(tableArray)):
                         columnDataArray=[]
                         mainDataJson = {}
                         currentTable= tableArray[j]
                         
-                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema='@DEMOVISINMEM' '''                  
+                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema=''' + schemaName                  
                         logger.log(f"selectQuery: {selectQuery}","0")
                         cursor = connectObj.cursor()
                         cursor.execute(selectQuery)
                         resultStr = cursor.fetchall()
                         
                         for i in range(len(resultStr)):
                             counter   += 1
```

## DatabaseCatlogUtility/DatabaseDremio.py

```diff
@@ -1,46 +1,48 @@
-#    -- WORKING  08-SEPT-2022  --
+#    -- WORKING  07-SEPT-2022  --
 
 import traceback
 import pandas as pd
 import loggerutility as logger
 
 class DatabaseDremio:
     
     def getTables(self,connectObj, dbDetails, userInfo, tableName=""):
         logger.log(f"Inside Dremio getTables()","0")
         resultStr = ""
         isTableFound = False
         schemaName = ""
         maxCount="500"
+        dbName = ""
         
         try:
             if len(userInfo) != 0:
+                if "DATABASE_SCHEMA" in  dbDetails.keys() :
+                    if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+                        dbName = dbDetails["DATABASE_SCHEMA"]
+                        logger.log(f"dbName:::{dbName}", "0")
                 
-                if "transDB" in userInfo.keys():
-                    if len(userInfo["transDB"]) != "" : 
-                        transDB = userInfo["transDB"]
-                 
-                schemaName = "'" + userInfo["transDB"] + "." + userInfo["transDB"] + "'"
+                schemaName =  "'" + dbName + "'"
+                logger.log(f"schemaName:::{schemaName}", "0")
                    
                 if ("" == tableName) :	
-                    selectQuery = '''select TABLE_NAME from INFORMATION_SCHEMA."TABLES" where table_type='TABLE' and table_schema= "''' + schemaName + '''" LIMIT ''' + maxCount
+                    selectQuery = '''select TABLE_NAME from INFORMATION_SCHEMA."TABLES" where table_type='VIEW' and table_schema= ''' + schemaName + ''' LIMIT ''' + maxCount
                     logger.log(f"SelectQuery dremio getTables: {selectQuery}","0")
                     cursor = connectObj.cursor()
                     cursor.execute(selectQuery)
                     resultStr = cursor.fetchall()
                     
                     tableJson={"Root":{"TABLEDETAILS":[]}}
                     for i in resultStr:
                         isTableFound = True
                         tableJson["Root"]["TABLEDETAILS"].append( { "TABLE_NAME" : i[0] }) 
                     logger.log(f"tablejson: {tableJson}","0")
                 else:
                     tableName = "'%"+tableName+"%'";
-                    selectQuery =  '''select TABLE_NAME from INFORMATION_SCHEMA.\"TABLES\" where table_type='TABLE' and table_schema='''+schemaName+" and table_name like "+tableName    
+                    selectQuery =  '''select TABLE_NAME from INFORMATION_SCHEMA.\"TABLES\" where table_type='VIEW' and table_schema='''+schemaName+" and table_name like "+tableName    
                     
                     logger.log(f"selectQuery: {selectQuery}","0")
                     cursor = connectObj.cursor()
                     cursor.execute(selectQuery)
                     resultStr = cursor.fetchall()
                     
                     tableJson={"Root":{"TABLEDETAILS":[]}}
@@ -55,30 +57,36 @@
                 if not isTableFound:
                     resultStr = self.getErrorXml("Tables not found in the InMemory Database against the Schema "+schemaName+"", "Table not Exist")
                     logger.log(f"error String dremio {resultStr}","0")
             
         except Exception as e:
             trace = traceback.format_exc()
             descr = str(e)
-            logger.log(f"{self.getErrorXml(descr, trace)}")
+            logger.log(f"{self.getErrorXml(descr, trace)}","0")
             
         finally:
             if connectObj != None:
                 connectObj.close()
         
         return resultStr    
             
     def getColumns(self, connectObj, tableNames, userInfo, dbDetails):
         logger.log(f"inside Dremio getColumns ","0")
-        if "transDB" in userInfo.keys():
-            if len(userInfo["transDB"]) != "" : 
-                transDB = userInfo["transDB"]
-                
         resultStr=""        
         mainDataArray=[]
+        dbName = ""
+        
+        if "DATABASE_SCHEMA" in  dbDetails.keys() :
+            if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+                    dbName = dbDetails["DATABASE_SCHEMA"]
+                    logger.log(f"dbName:::{dbName}", "0")
+            
+            schemaName =  "'" + dbName + "'"
+            logger.log(f"schemaName:::{schemaName}", "0")        
+        
         try:
             if len(userInfo) != 0:  
                 if  ("" != tableNames.upper()) or ("" != tableNames.lower()):
                     
                     tableArray = tableNames.split(",")
                     counter = 0 
                     
@@ -86,15 +94,15 @@
                         logger.log(f"Connected Dremio.","0")
 
                     for j in range(len(tableArray)):
                         columnDataArray=[]
                         mainDataJson = {}
                         currentTable= tableArray[j]
                         
-                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema='@DEMOVISINMEM' '''                  
+                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema='''   + schemaName                                  
                         logger.log(f"selectQuery: {selectQuery}","0")
                         cursor = connectObj.cursor()
                         cursor.execute(selectQuery)
                         resultStr = cursor.fetchall()
                         
                         for i in range(len(resultStr)):
                             counter   += 1
@@ -172,21 +180,23 @@
         finally:
             if connectObj != None:
                 connectObj.close()
         
         return resultStr
 
     def getTableData(self, connectObj, tableName, userInfo, dbDetails):
+        logger.log(f"inside getTableData() line 187","0")
         Database_Schema = ""
-        if 'Database_Schema' in dbDetails.keys():
-            if dbDetails['Database_Schema'] != None:
-                Database_Schema = dbDetails['Database_Schema']
+        if 'DATABASE_SCHEMA' in dbDetails.keys():
+            if dbDetails['DATABASE_SCHEMA'] != None:
+                Database_Schema = dbDetails['DATABASE_SCHEMA']
+                logger.log(f"Database_Schema line 192: {Database_Schema}","0")
 
         selectQuery = '''SELECT * FROM "''' + Database_Schema + '''".''' + tableName + " WHERE ROWNUM <= 50"
-        logger.log(f"selectQuery: {selectQuery}","0")
+        logger.log(f"selectQuery line 195: {selectQuery}","0")
         df = pd.read_sql(selectQuery, connectObj)
         tableDataJson = df.assign( **df.select_dtypes(['datetime']).astype(str).to_dict('list') ).to_json(orient="records")
         logger.log(f"tableDataJson: {tableDataJson}","0")
         return tableDataJson
 
 
     def getErrorXml(self, descr, trace):
@@ -201,8 +211,7 @@
                                     <type>E</type>
                                 </error>
                             </Errors>
                         </Root>'''
         
         return errorXml
 
-
```

## DatabaseCatlogUtility/DatabaseInMemory.py

```diff
@@ -1,45 +1,48 @@
-#    -- WORKING  08-SEPT-2022  --
+#    -- WORKING  07-SEPT-2022  --S
 
 import traceback
 import pandas as pd
 import loggerutility as logger
 
 class DatabaseInMemory:
     
     def getTables(self,connectObj, dbDetails, userInfo, tableName=""):
         logger.log(f"Inside DatabaseInMemory getTables()","0")
         resultStr = ""
         isTableFound = False
         schemaName = ""
         maxCount="500"
+        dbName = ""
         
         try:
             if len(userInfo) != 0:
-                if "transDB" in userInfo.keys():
-                    if len(userInfo["transDB"]) != "" : 
-                        transDB = userInfo["transDB"]
-                 
-                schemaName = "'" + userInfo["transDB"] + "." + userInfo["transDB"] + "'"
+                if "DATABASE_SCHEMA" in  dbDetails.keys() :
+                    if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+                        dbName = dbDetails["DATABASE_SCHEMA"]
+                        logger.log(f"dbName:::{dbName}", "0")
+                
+                schemaName =  "'" + dbName + "'"
+                logger.log(f"schemaName:::{schemaName}", "0")
                 
                 if ("" == tableName) :	
-                    selectQuery = '''select TABLE_NAME from INFORMATION_SCHEMA."TABLES" where table_type='TABLE' and table_schema= ''' + schemaName + " LIMIT " + maxCount
-                    logger.log(f"Inside DatabaseInMemory getTables selectQuery: {selectQuery}","0")
+                    selectQuery = '''select TABLE_NAME from INFORMATION_SCHEMA."TABLES" where table_type='VIEW' and table_schema= ''' + schemaName + " LIMIT " + maxCount
+                    logger.log(f"\n\nInside DatabaseInMemory getTables selectQuery: {selectQuery}\n\n","0")
                     cursor = connectObj.cursor()
                     cursor.execute(selectQuery)
                     resultStr = cursor.fetchall()
                     
                     tableJson={"Root":{"TABLEDETAILS":[]}}
                     for i in resultStr:
                         isTableFound = True
                         tableJson["Root"]["TABLEDETAILS"].append( { "TABLE_NAME" : i[0] }) 
                     logger.log(f"Inside DatabaseInMemory tablejson: {tableJson}","0")
                 else:
                     tableName = "'%"+tableName+"%'";
-                    selectQuery =  '''select TABLE_NAME from INFORMATION_SCHEMA.\"TABLES\" where table_type='TABLE' and table_schema='''+schemaName+" and table_name like "+tableName    
+                    selectQuery =  '''select TABLE_NAME from INFORMATION_SCHEMA.\"TABLES\" where table_type='VIEW' and table_schema='''+schemaName+" and table_name like "+tableName    
                     
                     logger.log(f"Inside DatabaseInMemory selectQuery: {selectQuery}","0")
                     cursor = connectObj.cursor()
                     cursor.execute(selectQuery)
                     resultStr = cursor.fetchall()
                     
                     tableJson={"Root":{"TABLEDETAILS":[]}}
@@ -54,31 +57,37 @@
                 if not isTableFound:
                     resultStr = self.getErrorXml("Tables not found in the InMemory Database against the Schema "+schemaName+"", "Table not Exist")
                     logger.log(f"Inside DatabaseInMemory error String: {resultStr}","0")
             
         except Exception as e:
             trace = traceback.format_exc()
             descr = str(e)
-            logger.log(f"{self.getErrorXml(descr, trace)}")
+            logger.log(f"{self.getErrorXml(descr, trace)}","0")
             
         finally:
             if connectObj != None:
                 connectObj.close()
         
         return resultStr    
             
     def getColumns(self, connectObj, tableNames, userInfo, dbDetails):
         logger.log(f"Inside DatabaseInMemory getColumns ","0")
-        if "transDB" in userInfo.keys():
-            if len(userInfo["transDB"]) != "" : 
-                transDB = userInfo["transDB"]
-                
+        
         resultStr=""        
         mainDataArray=[]
+        dbName = ""
         
+        if "DATABASE_SCHEMA" in  dbDetails.keys() :
+            if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+                    dbName = dbDetails["DATABASE_SCHEMA"]
+                    logger.log(f"dbName:::{dbName}", "0")
+            
+            schemaName =  "'" + dbName + "'"
+            logger.log(f"schemaName:::{schemaName}", "0")        
+
         try:
             if len(userInfo) != 0:  
                 if  ("" != tableNames.upper()) or ("" != tableNames.lower()):
                     
                     tableArray = tableNames.split(",")
                     counter = 0 
                     
@@ -86,15 +95,15 @@
                         logger.log(f" Connected InMemory.","0")
 
                     for j in range(len(tableArray)):
                         columnDataArray=[]
                         mainDataJson = {}
                         currentTable= tableArray[j]
                         
-                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema='@DEMOVISINMEM' '''                  
+                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema=''' + schemaName                  
                         logger.log(f"selectQuery: {selectQuery}","0")
                         cursor = connectObj.cursor()
                         cursor.execute(selectQuery)
                         resultStr = cursor.fetchall()
                         
                         for i in range(len(resultStr)):
                             counter   += 1
@@ -172,21 +181,23 @@
         finally:
             if connectObj != None:
                 connectObj.close()
         
         return resultStr
 
     def getTableData(self, connectObj, tableName, userInfo, dbDetails):
+        logger.log(f"inside getTableData() line 188","0")
         Database_Schema = ""
-        if 'Database_Schema' in dbDetails.keys():
-                if dbDetails['Database_Schema'] != None:
-                    Database_Schema = dbDetails['Database_Schema']
+        if 'DATABASE_SCHEMA' in dbDetails.keys():
+                if dbDetails['DATABASE_SCHEMA'] != None:
+                    Database_Schema = dbDetails['DATABASE_SCHEMA']
+                    logger.log(f"Database_Schema line 193: {Database_Schema}","0")
 
         selectQuery = '''SELECT * FROM "''' + Database_Schema + '''".''' + tableName + " WHERE ROWNUM <= 50"
-        logger.log(f"selectQuery: {selectQuery}","0")
+        logger.log(f"selectQuery line 196: {selectQuery}","0")
         df = pd.read_sql(selectQuery, connectObj)
         tableDataJson = df.assign( **df.select_dtypes(['datetime']).astype(str).to_dict('list') ).to_json(orient="records")
         logger.log(f"tableDataJson: {tableDataJson}","0")
         return tableDataJson
 
     def getErrorXml(self, descr, trace):
         errorXml ='''<Root>
@@ -200,8 +211,7 @@
                                     <type>E</type>
                                 </error>
                             </Errors>
                         </Root>'''
         
         return errorXml
 
-
```

## DatabaseCatlogUtility/DatabaseMSSQLServer.py

```diff
@@ -1,9 +1,7 @@
-# version - 0.0.4
-
 import loggerutility as logger
 import pandas as pd
 import traceback
 
 class DatabaseMSSQLServer:
     
     def getTables(self,connectObj, dbDetails, userInfo, tableName=""):
```

## DatabaseCatlogUtility/DatabaseOracle.py

```diff
@@ -1,8 +1,8 @@
-#    -- WORKING  08-SEPT-2022  --
+#    -- WORKING  07-SEPT-2022  --
 
 import loggerutility as logger
 import pandas as pd
 import traceback
 
 class DatabaseOracle:
     
@@ -95,15 +95,15 @@
                      
                     for j in range(len(tableArray)):
                         
                         columnDataArray=[]
                         mainDataJson = {}
                         currentTable= tableArray[j]
                         selectQuery = " SELECT COLUMN_NAME, DATA_LENGTH, DATA_TYPE, NULLABLE FROM ALL_TAB_COLUMNS WHERE TABLE_NAME= '"+ tableArray[j].upper()+"' and OWNER= '" + transDB.upper() + "'"     
-                        logger.log("selectQuery: {selectQuery}","0")
+                        logger.log(f"selectQuery: {selectQuery}","0")
                         
                         cursor = connectObj.cursor()
                         cursor.execute(selectQuery)
                         resultStr = cursor.fetchall()
                         logger.log(f"resultStr line 107: {resultStr}","0")
                         
                         for i in range(len(resultStr)):
@@ -129,14 +129,15 @@
                                 javaType = "java.sql.Date"
                             
                             else:
                                 pass
                             
                             if( not"".lower() == defaultFunction.lower()):
                                 expression = defaultFunction + "(" + columnName +")" 
+                                logger.log(f"expression : {expression}","0")
                             
                             else:
                                 pass
                             
                             columnData["DBNAME"]            =   columnName
                             columnData["NAME"]              =   columnName
                             columnData["CAPS"]              =   "false"
@@ -209,8 +210,7 @@
                                 </error>
                             </Errors>
                         </Root>'''
         
         return errorXml
 
     
-
```

## DatabaseCatlogUtility/DatabaseSAPHANA.py

```diff
@@ -1,9 +1,7 @@
-
-
 import loggerutility as logger
 import pandas as pd
 import traceback
 
 class DatabaseSAPHANA:
     
     def getTables(self,connectObj, dbDetails, userInfo, tableName=""):
@@ -83,20 +81,20 @@
                      
                     for j in range(len(tableArray)):
                         
                         columnDataArray=[]
                         mainDataJson = {}
                         currentTable= tableArray[j]
                         selectQuery = '''SELECT * FROM SYS.TABLE_COLUMNS WHERE TABLE_NAME = "''' + tableArray[j].upper()+'''" ORDER BY POSITION'''
-                        logger.log("selectQuery: {selectQuery}","0")
+                        logger.log(f"selectQuery: {selectQuery}","0")
                         
                         cursor = connectObj.cursor()
                         cursor.execute(selectQuery)
                         resultStr = cursor.fetchall()
-                        logger.log("resultStr getColumns DatabaseSAPHANA: {resultStr}", "0")
+                        logger.log(f"resultStr getColumns DatabaseSAPHANA: {resultStr}", "0")
                         
                         for i in range(len(resultStr)):
                             counter+=1
                             columnData = {}
                             columnName = resultStr[i][0]
                             columnSize = resultStr[i][1] 
                             colType    = resultStr[i][2]
@@ -195,8 +193,7 @@
                                 </error>
                             </Errors>
                         </Root>'''
         
         return errorXml
 
     
-
```

## DatabaseCatlogUtility/DatabaseSQLServer.py

```diff
@@ -122,15 +122,18 @@
                             elif ("NUMBER".lower() == colType.lower()):
                                 javaType = "java.math.BigDecimal"
                                 defaultFunction = "SUM"
                             
                             elif ("DATE".lower() == colType.lower()):
                                 javaType = "java.sql.Date"
                             
-                            elif( not"".lower() == defaultFunction.lower()):
+                            else:
+                                pass
+                            
+                            if( not"".lower() == defaultFunction.lower()):
                                 expression = defaultFunction + "(" + columnName +")" 
                             
                             else:
                                 pass
                             
                             columnData["DBNAME"]            =   columnName
                             columnData["NAME"]              =   columnName
```

## DatabaseCatlogUtility/DatabaseSnowFlake.py

```diff
@@ -8,22 +8,28 @@
     
     def getTables(self,connectObj, dbDetails, userInfo, tableName=""):
         logger.log(f"Inside DatabaseSnowFlake getTables()","0")
         resultStr = ""
         isTableFound = False
         schemaName = ""
         maxCount="500"
-        
+        dbName = ""
         try:
             if len(userInfo) != 0:
-                if "transDB" in userInfo.keys():
-                    if len(userInfo["transDB"]) != "" : 
-                        transDB = userInfo["transDB"]
-                 
-                schemaName = "'" + userInfo["transDB"] + "." + userInfo["transDB"] + "'"
+                if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+                    dbName = dbDetails["DATABASE_SCHEMA"]
+                    logger.log(f"dbName:::{dbName}", "0")
+                    
+                else:
+                    if "transDB" in userInfo.keys():
+                        if len(userInfo["transDB"]) != "" : 
+                            dbName = userInfo["transDB"]
+                
+                schemaName =  "'" + dbName + "." + dbName + "'"
+                logger.log(f"schemaName:::{schemaName}", "0")  
                 
                 if ("" == tableName) :	
                     selectQuery = '''select TABLE_NAME from INFORMATION_SCHEMA."TABLES" where table_type='TABLE' and table_schema= ''' + schemaName + " LIMIT " + maxCount
                     logger.log(f"Inside DatabaseSnowFlake getTables selectQuery: {selectQuery}","0")
                     cursor = connectObj.cursor()
                     cursor.execute(selectQuery)
                     resultStr = cursor.fetchall()
@@ -64,21 +70,30 @@
             if connectObj != None:
                 connectObj.close()
         
         return resultStr    
             
     def getColumns(self, connectObj, tableNames, userInfo, dbDetails):
         logger.log(f"Inside DatabaseSnowFlake getColumns ","0")
-        if "transDB" in userInfo.keys():
-            if len(userInfo["transDB"]) != "" : 
-                transDB = userInfo["transDB"]
-                
         resultStr=""        
         mainDataArray=[]
+        dbName = ""
+
+        if dbDetails["DATABASE_SCHEMA"] != None or len(dbDetails["DATABASE_SCHEMA"]) > 0 :
+            dbName = dbDetails["DATABASE_SCHEMA"]
+            logger.log(f"dbName:::{dbName}", "0")
+            
+        else:
+            if "transDB" in userInfo.keys():
+                if len(userInfo["transDB"]) != "" : 
+                    dbName = userInfo["transDB"]
         
+        schemaName =  "'" + dbName + "." + dbName + "'"
+        logger.log(f"schemaName:::{schemaName}", "0")  
+
         try:
             if len(userInfo) != 0:  
                 if  ("" != tableNames.upper()) or ("" != tableNames.lower()):
                     
                     tableArray = tableNames.split(",")
                     counter = 0 
                     
@@ -86,15 +101,15 @@
                         logger.log(f" Connected InMemory.","0")
 
                     for j in range(len(tableArray)):
                         columnDataArray=[]
                         mainDataJson = {}
                         currentTable= tableArray[j]
                         
-                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema='@DEMOVISINMEM' '''                  
+                        selectQuery = '''select COLUMN_NAME, COLUMN_SIZE, DATA_TYPE, IS_NULLABLE from INFORMATION_SCHEMA."COLUMNS" where table_name='''  + "'" + tableArray[j].upper() + "'" + ''' AND table_schema=''' + schemaName                  
                         logger.log(f"selectQuery: {selectQuery}","0")
                         cursor = connectObj.cursor()
                         cursor.execute(selectQuery)
                         resultStr = cursor.fetchall()
                         
                         for i in range(len(resultStr)):
                             counter   += 1
```

## DatabaseCatlogUtility/Databasecatlog.py

```diff
@@ -1,9 +1,7 @@
-# version - 0.0.4
-
 from .DatabaseOracle import DatabaseOracle 
 from .DatabaseDremio import DatabaseDremio
 from .DatabaseInMemory import DatabaseInMemory
 from .DatabaseMySql import DatabaseMySql 
 from .DatabaseMSSQLServer import DatabaseMSSQLServer 
 from .DatabaseSAPHANA import DatabaseSAPHANA 
 from .DatabasePostgress import DatabasePostgress
```

## Comparing `DatabaseCatlogUtility-0.0.4.dist-info/LICENCE.txt` & `DatabaseCatlogUtility-0.0.5.dist-info/LICENCE.txt`

 * *Files identical despite different names*

## Comparing `DatabaseCatlogUtility-0.0.4.dist-info/RECORD` & `DatabaseCatlogUtility-0.0.5.dist-info/RECORD`

 * *Files 13% similar despite different names*

```diff
@@ -1,18 +1,18 @@
-DatabaseCatlogUtility/DatabaseAmazonRedshift.py,sha256=3bBJXrmtBZxdLjq54gAQBTbIdR7LPQAmlStFUH7FbQ8,10283
-DatabaseCatlogUtility/DatabaseDremio.py,sha256=f0_M1C0BQnC-uCaFr30ZCbQ18h4PkKH48Swmmlll7H4,10109
+DatabaseCatlogUtility/DatabaseAmazonRedshift.py,sha256=_bs58FOcsTYakyM1o2aw8YE0FuWFeZsfUT8Lt4kqC0w,10952
+DatabaseCatlogUtility/DatabaseDremio.py,sha256=fY2G-BW2dSMFRcHIu8-3yPN1TGtT66ieJ3TA2IBdyLs,10692
 DatabaseCatlogUtility/DatabaseGoogleBigQuery.py,sha256=vFtLsXviCFdCb7kcckV0EPdzv4WU-Md3-5Dwe_gy3dA,10279
-DatabaseCatlogUtility/DatabaseInMemory.py,sha256=eEe_NHACI760p-BZxbu3mrfPLwNUnE1sBkDP3jtpL3U,10231
-DatabaseCatlogUtility/DatabaseMSSQLServer.py,sha256=6v8Dl-Ey-BMQu9mL9r1_HdzSosrSTyz_vNS6_z2s0Rs,10486
+DatabaseCatlogUtility/DatabaseInMemory.py,sha256=yqjT35_-uHakYDec1VTgeRfAc10HIbZAsk6eCH0I0Hc,10820
+DatabaseCatlogUtility/DatabaseMSSQLServer.py,sha256=Nu5WPTjHHs22czCXNJ8QHzS4NsRa0r3qHOJL9PQ8ba4,10467
 DatabaseCatlogUtility/DatabaseMySql.py,sha256=Mudyvb4-Dyj45FLgPfxjXH_lvI2Kssfl_A-srvG7nHs,10556
-DatabaseCatlogUtility/DatabaseOracle.py,sha256=nkCWhYnClP_snTiLCoWS3VqqHH7-Xk5J73LqvCVvBpM,10491
+DatabaseCatlogUtility/DatabaseOracle.py,sha256=_Q8NYi0e_sWCq13e2wq-NRsaXWGG8I697Q_GZcYpXTA,10568
 DatabaseCatlogUtility/DatabasePostgress.py,sha256=hYZrirw0BT1b0zYSGaAs4pQ871reGQr8u1sxluBMuUA,10470
-DatabaseCatlogUtility/DatabaseSAPHANA.py,sha256=-CSRYNJkCNuJ0ABCxZGKB_SKXDUUVB8woSY00ueTlW4,9937
-DatabaseCatlogUtility/DatabaseSQLServer.py,sha256=GKKLpeOjEl-Yb5gwGfgtXhPpCQjmKA5lqTv8vt3Ur4U,10345
-DatabaseCatlogUtility/DatabaseSnowFlake.py,sha256=RIHahH4w2-bJzqyfv43wjsC3QWOFzXHkg2SnxTbzCns,10242
-DatabaseCatlogUtility/Databasecatlog.py,sha256=Um2fQQ2ZQfaqAhws0Aef2TxTepHcWIlUKPZi-8ZyX6A,3909
+DatabaseCatlogUtility/DatabaseSAPHANA.py,sha256=gqHqpMTfFPGwFo_EiSch_n8EEu6p1df2TmXcWI8uc1c,9936
+DatabaseCatlogUtility/DatabaseSQLServer.py,sha256=M590L2VFn2rz1n0xZmlT8shwoi2lxPp1ytlLKbHXlr4,10443
+DatabaseCatlogUtility/DatabaseSnowFlake.py,sha256=L3J_fSvN0eRPOQ_LQ8awgQW4xJHCUa04JezerclCdYQ,10903
+DatabaseCatlogUtility/Databasecatlog.py,sha256=VesQ8kTyfiKI8gXXC87fLFEqIgctd_2p_Yk0y35k9T8,3890
 DatabaseCatlogUtility/__init__.py,sha256=SDk4YhcUvDsWcl6p90nE5TKQFbmAYZyYD-9RSIMvG2M,532
-DatabaseCatlogUtility-0.0.4.dist-info/LICENCE.txt,sha256=2qX9IkEUBx0VJp1Vh9O2dsRwE-IpYId0lXDyn7OVsJ8,1073
-DatabaseCatlogUtility-0.0.4.dist-info/METADATA,sha256=XIM9M6wz6ha5ug97N-i4NXw3fIaABCA6UzRj-r5fGQQ,591
-DatabaseCatlogUtility-0.0.4.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-DatabaseCatlogUtility-0.0.4.dist-info/top_level.txt,sha256=x-nXLKPqMuM_w4Bn35VbWLTDWjVG8RiYYYFXYl7C1rM,22
-DatabaseCatlogUtility-0.0.4.dist-info/RECORD,,
+DatabaseCatlogUtility-0.0.5.dist-info/LICENCE.txt,sha256=2qX9IkEUBx0VJp1Vh9O2dsRwE-IpYId0lXDyn7OVsJ8,1073
+DatabaseCatlogUtility-0.0.5.dist-info/METADATA,sha256=SVkxo6mElhro_F4Z7rIHycZwFoNZL3ibEEbCDX6xlQ0,541
+DatabaseCatlogUtility-0.0.5.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+DatabaseCatlogUtility-0.0.5.dist-info/top_level.txt,sha256=x-nXLKPqMuM_w4Bn35VbWLTDWjVG8RiYYYFXYl7C1rM,22
+DatabaseCatlogUtility-0.0.5.dist-info/RECORD,,
```

